(()=>{"use strict";function e(e,t){return chrome.i18n.getMessage(e,t)||e}const t={get:e,localize:function(t=document){t.querySelectorAll("[data-i18n]").forEach(t=>{const n=t.getAttribute("data-i18n");n&&(t.textContent=e(n))}),t.querySelectorAll("[data-i18n-attr]").forEach(t=>{const n=t.getAttribute("data-i18n-attr");if(n)for(const a of n.split(";")){const[n,r]=a.split(":").map(e=>e?.trim());n&&r&&t.setAttribute(n,e(r))}})}},n="PING",a="TOGGLE_SELECT",r="RENDER",o="CLEAR",c="SELECTED";function i(e){return!e||e.startsWith("chrome://")||e.startsWith("edge://")||e.startsWith("about:")||e.startsWith("moz-extension://")}const s="spsk:panel-content:v1";class d{rpc;constructor(e){this.rpc=e}send(e){const t={id:crypto.randomUUID(),expectReply:!1,...e};return this.rpc.send(t)}render(e){return this.send({type:r,payload:{items:e}})}toggleSelect(e){return this.send({type:a,payload:{enabled:e}})}clear(){return this.send({type:o})}ping(){const e={id:crypto.randomUUID(),expectReply:!0,type:n};return this.rpc.send(e,5e3)}}class l{port;pending=new Map;constructor(e){this.port=e,this.port.onMessage.addListener(e=>{(function(e){return"object"==typeof e&&null!==e&&"id"in e&&"ok"in e})(e)&&(this.pending.get(e.id)?.(e),this.pending.delete(e.id))}),this.port.onDisconnect.addListener(()=>{for(const[,e]of this.pending)e({id:"",ok:!1,error:"disconnected"});this.pending.clear()})}send(e,t=5e3){return new Promise(n=>{if(e.expectReply){const a=setTimeout(()=>{this.pending.delete(e.id),n(void 0)},t);this.pending.set(e.id,e=>{clearTimeout(a),n(e)})}this.port.postMessage(e),e.expectReply||n(void 0)})}}function m(){const e=chrome.runtime.lastError;return e?new Error(e.message||String(e)):null}async function u(e,t,n){return await new Promise((a,r)=>{chrome.debugger.sendCommand(e,t,n??{},e=>{const t=m();t?r(t):a(e??{})})})}const g="screenStateByPage";async function p(){return(await chrome.storage.local.get(g))[g]??{}}async function h(e){return(await p())[e]??{items:[],nextId:1,nextLabel:1}}async function f(e,t){const n=await p();n[e]=t,await async function(e){await chrome.storage.local.set({[g]:e})}(n)}const y={RESTRICTED:"status_restricted",CONNECTING:"status_connecting",CONNECTED:"status_connected",DISCONNECTED:"status_disconnected"},b={RESTRICTED:{body:["bg-amber-50","border-amber-200","text-amber-700","dark:bg-amber-950","dark:border-amber-900/50","dark:text-amber-300"],dot:["bg-amber-500"]},CONNECTING:{body:["bg-sky-50","border-sky-200","text-sky-700","dark:bg-sky-950","dark:border-sky-900/50","dark:text-sky-300"],dot:["bg-sky-500"]},CONNECTED:{body:["bg-emerald-50","border-emerald-200","text-emerald-700","dark:bg-emerald-950","dark:border-emerald-900/50","dark:text-emerald-300"],dot:["bg-emerald-500"]},DISCONNECTED:{body:["bg-rose-50","border-rose-200","text-rose-700","dark:bg-rose-950","dark:border-rose-900/50","dark:text-rose-300"],dot:["bg-rose-500"]}},w=document.getElementById("status"),E=document.getElementById("toggle-select-icon"),x=document.getElementById("toggle-select-label"),C=document.getElementById("select-count"),I=document.getElementById("select-empty"),k=document.getElementById("select-list"),v=["inline-flex","items-center","gap-1","rounded-full","border","px-2","py-1","text-xs","transition-colors"],N=["inline-block","w-3","h-3","rounded-full"],S=["bg-emerald-500"],D=["bg-slate-300"];function T(e){const n=b[e];w.className="",w.classList.add(...v,...n.body);const a=document.createElement("span");a.classList.add("h-1.5","w-1.5","rounded-full",...n.dot);const r=document.createElement("span");r.textContent=function(e){const n=y[e];return t.get(n)||n}(e),w.replaceChildren(a,r)}function L(e){const t=0===e.length;if(C.textContent=String(e.length),t)return I.classList.remove("hidden"),void k.replaceChildren();I.classList.add("hidden");const n=document.createDocumentFragment();for(const t of e){const e=document.createElement("li");e.className="group flex items-center gap-3 p-3 hover:bg-slate-50 dark:hover:bg-slate-800/60",e.dataset.id=String(t.id);const a=document.createElement("span");a.className="inline-flex h-6 w-6 items-center justify-center rounded-md bg-indigo-600/10 text-indigo-700 dark:text-indigo-300 text-xs font-semibold",a.textContent=String(t.label);const r=document.createElement("div");r.className="min-w-0 flex-1";const o=document.createElement("div");o.className="text-sm font-medium truncate",o.textContent=t.anchor.value,r.append(o),e.append(a,r),n.appendChild(e)}k.replaceChildren(n)}const M=document.getElementById("toggle-select"),R=document.getElementById("toggle-label"),B=document.getElementById("clear"),O=document.getElementById("capture");let $=null,P="",_=!1;(async function(){t.localize(document);const e=await async function(){return(await chrome.tabs.query({active:!0,currentWindow:!0}))[0]}();if(!e?.id||i(e.url))return T("RESTRICTED");$=e.id,P=function(e,t=!1){try{const n=new URL(e);return t?`${n.origin}${n.pathname}${n.search}${n.hash}`:`${n.origin}${n.pathname}${n.search}`}catch{return e}}(e.url),T("CONNECTING");const n=await async function(e){await chrome.scripting.executeScript({target:{tabId:e},files:["content/main.js"]}).catch(()=>{});const t=chrome.tabs.connect(e,{name:s}),n=new l(t),a=new d(n),r=[];return t.onDisconnect.addListener(()=>r.forEach(e=>e())),{api:a,port:t,rpc:n,onDisconnect:e=>r.push(e),dispose:()=>{try{t.disconnect()}catch{}}}}($);n.onDisconnect(()=>{T("DISCONNECTED"),_=!1,R.textContent=t.get("toggle_off")}),n.port.onMessage.addListener(async e=>{if(e&&e.type&&e.type===c){const t=await async function(e,t){const n=await h(e),a=Array.from(new Set(t.map(e=>e.value))).map(e=>t.find(t=>t.value===e)).filter(Boolean),r=[],o=[];for(const e of a){const t=n.items.find(t=>t.anchor.kind===e.kind&&t.anchor.value===e.value);t?r.push(t.id):o.push({anchor:e})}const c={};return r.length&&(c.removedIds=r),o.length&&(c.added=o),async function(e,t){const n=await h(e),a=!(!t.removedIds||!t.removedIds.length);if(t.removedIds?.length){const e=new Set(t.removedIds);n.items=n.items.filter(t=>!e.has(t.id))}if(t.updated?.length){const e=new Map(n.items.map(e=>[e.id,e]));for(const n of t.updated){const t=e.get(n.id);t&&("number"==typeof n.label&&(t.label=n.label),n.anchor&&(t.anchor=n.anchor),n.meta&&(t.meta=n.meta))}}if(t.added?.length)for(const e of t.added){const t={id:n.nextId++,label:"number"==typeof e.label?e.label:n.nextLabel++,anchor:e.anchor,...e.meta?{meta:e.meta}:{}};n.items.push(t)}return a&&function(e){e.items.forEach((e,t)=>{e.label=t+1}),e.nextLabel=e.items.length+1}(n),await f(e,n),n}(e,c)}(P,e.payload.anchors);L(t.items),await n.api.render(t.items)}});const a=await h(P);await n.api.render(a.items),L(a.items),T("CONNECTED"),M.onclick=async()=>{var e;_=!_,e=_,E.className="",E.classList.add(...N,...e?S:D),x.textContent=t.get(e?"toggle_on":"toggle_off"),await n.api.toggleSelect(_)},B.onclick=async()=>{await f(P,{items:[],nextId:1,nextLabel:1}),L([]),await n.api.clear()},O.onclick=async()=>{try{await async function(e){const t=await chrome.tabs.get(e.tabId);if(!t.id||i(t.url))return void console.warn("Capturing is not possible due to restricted URL:",t.url);const n={tabId:t.id},a=e.format??"png",r=e.settleMs??500,o=e.scale??1;await async function(e){await new Promise((t,n)=>{chrome.debugger.attach(e,"1.3",()=>{const e=m();e?n(e):t()})})}(n);try{await u(n,"Page.enable"),(e.bringToFront??1)&&await u(n,"Page.bringToFront");const c=await u(n,"Page.getLayoutMetrics"),i=Math.max(1,0|Math.ceil(c.cssContentSize?.width??1)),s=Math.max(1,0|Math.ceil(c.cssContentSize?.height??1));await u(n,"Emulation.setDeviceMetricsOverride",{width:i,height:s,deviceScaleFactor:1,mobile:!1,screenWidth:i,screenHeight:s,positionX:0,positionY:0}),await u(n,"Runtime.evaluate",{expression:"window.scrollTo(0,0)"}),await new Promise(e=>setTimeout(e,r));const d={format:a,fromSurface:!0,captureBeyondViewport:!0,clip:{x:0,y:0,width:i,height:s,scale:o}};"jpeg"===a&&"number"==typeof e.quality&&(d.quality=Math.min(100,Math.max(0,Math.round(e.quality))));const{data:l}=await u(n,"Page.captureScreenshot",d),m=`data:${"png"===a?"image/png":"image/jpeg"};base64,${l}`,g=e.filename??function(e,t){let n=(e.title&&e.title.trim()?e.title:"")||(()=>{try{return new URL(e.url??"").host||"page"}catch{return"page"}})();return n=n.replace(/[\\/:*?"<>|]/g,"_").replace(/\s+/g," ").trim(),n.length>80&&(n=n.slice(0,80)),`${n}-${(new Date).toISOString().replace(/[:.]/g,"-")}.${t}`}(t,a);return await chrome.downloads.download({url:m,filename:g,saveAs:!1})}finally{try{await u(n,"Emulation.clearDeviceMetricsOverride")}catch{}try{await async function(e){await new Promise(t=>{chrome.debugger.detach(e,()=>t())})}(n)}catch{}}}({tabId:$})}catch(e){console.error("Full capture failed",e)}}})().catch(console.error)})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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LFNBQVMsQ0FDL0MvTixNQUNBcU4sV0FDQVcsUUFBUSxHQUdoQixDQUNBLFFBRUksVUFDVXpOLEVBQUs0QyxFQUFRLHVDQUN2QixDQUNBLE1BQW9CLENBRXBCLFVQbEVERCxlQUFzQkMsU0FDbkIsSUFBSWYsUUFBU0osSUFDZnJELE9BQU80RSxTQUFTMEssT0FBTzlLLEVBQVEsSUFBTW5CLE1BRTdDLENPK0RrQmlNLENBQU85SyxFQUNqQixDQUNBLE1BQW9CLENBQ3hCLENBQ0osQ0huQ2tCK0ssQ0FBZ0IsQ0FBRTFGLE1BQU9qQixHQUNuQyxDQUNBLE1BQU80RyxHQUNIL0MsUUFBUWxKLE1BQU0sc0JBQXVCaU0sRUFDekMsRUFFUixFQTdEQXRILEdBQU8rQixNQUFNd0MsUUFBUWxKLE0iLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9jb21tb24vaTE4bi50cyIsIndlYnBhY2s6Ly8vLi9jb21tb24vbWVzc2FnZXMudHMiLCJ3ZWJwYWNrOi8vLy4vY29tbW9uL3VybC50cyIsIndlYnBhY2s6Ly8vLi9jb21tb24vY29uc3RhbnRzLnRzIiwid2VicGFjazovLy8uL3J1bnRpbWUvcGFuZWwvbWVzc2FnaW5nL2FwaS50cyIsIndlYnBhY2s6Ly8vLi9ydW50aW1lL3BhbmVsL21lc3NhZ2luZy9wb3J0X3JwYy50cyIsIndlYnBhY2s6Ly8vLi9pbmZyYS9jZHAvY2RwX2NsaWVudC50cyIsIndlYnBhY2s6Ly8vLi9ydW50aW1lL3BhbmVsL3N0YXRlL3N0b3JlLnRzIiwid2VicGFjazovLy8uL3J1bnRpbWUvcGFuZWwvdmlldy9zdGF0dXMudHMiLCJ3ZWJwYWNrOi8vLy4vcnVudGltZS9wYW5lbC92aWV3L3VpLnRzIiwid2VicGFjazovLy8uL3J1bnRpbWUvcGFuZWwvYXBwL2luZGV4LnRzIiwid2VicGFjazovLy8uL2luZnJhL2Nocm9tZS90YWJzLnRzIiwid2VicGFjazovLy8uL3J1bnRpbWUvcGFuZWwvbWVzc2FnaW5nL2Nvbm5lY3Rpb24udHMiLCJ3ZWJwYWNrOi8vLy4vcnVudGltZS9wYW5lbC9zZXJ2aWNlcy9jYXB0dXJlLnRzIl0sInNvdXJjZXNDb250ZW50IjpbImNvbnN0IGkxOG4gPSB7IGdldCwgbG9jYWxpemUgfTtcbi8qKlxuICogUmV0cmlldmVzIGEgbG9jYWxpemVkIG1lc3NhZ2UgYnkga2V5LiBGYWxscyBiYWNrIHRvIHRoZSBrZXkgaXRzZWxmIHdoZW4gbm90IGZvdW5kLlxuICpcbiAqIEBwYXJhbSBrZXkgLSBLZXkgZGVmaW5lZCBpbiBfbG9jYWxlcy9tZXNzYWdlcy5qc29uXG4gKiBAcGFyYW0gc3VicyAtIE9wdGlvbmFsIHN1YnN0aXR1dGlvbiBhcmd1bWVudHNcbiAqIEByZXR1cm5zIExvY2FsaXplZCBzdHJpbmdcbiAqL1xuZnVuY3Rpb24gZ2V0KGtleSwgc3Vicykge1xuICAgIHJldHVybiBjaHJvbWUuaTE4bi5nZXRNZXNzYWdlKGtleSwgc3VicykgfHwga2V5O1xufVxuLyoqXG4gKiBXYWxrcyB0aGUgRE9NIGFuZCBhcHBsaWVzIGxvY2FsaXplZCBzdHJpbmdzIHRvIGVsZW1lbnRzIHdpdGhcbiAqIGBkYXRhLWkxOG5gIGFuZCBgZGF0YS1pMThuLWF0dHJgLlxuICpcbiAqIEBwYXJhbSByb290IC0gUm9vdCBub2RlIHRvIGxvY2FsaXplIChkZWZhdWx0cyB0byBkb2N1bWVudClcbiAqIEByZW1hcmtzXG4gKiAtIGBkYXRhLWkxOG5gIHJlcGxhY2VzIGB0ZXh0Q29udGVudGAuXG4gKiAtIGBkYXRhLWkxOG4tYXR0cmAgdXNlcyBgYXR0cjprZXk7YXR0cjprZXk7Li4uYCB0byBzZXQgYXR0cmlidXRlcy5cbiAqIC0gTXV0YXRlcyB0aGUgRE9NIGluIHBsYWNlLlxuICovXG5mdW5jdGlvbiBsb2NhbGl6ZShyb290ID0gZG9jdW1lbnQpIHtcbiAgICByb290LnF1ZXJ5U2VsZWN0b3JBbGwoJ1tkYXRhLWkxOG5dJykuZm9yRWFjaChlbCA9PiB7XG4gICAgICAgIGNvbnN0IGtleSA9IGVsLmdldEF0dHJpYnV0ZSgnZGF0YS1pMThuJyk7XG4gICAgICAgIGlmIChrZXkpXG4gICAgICAgICAgICBlbC50ZXh0Q29udGVudCA9IGdldChrZXkpO1xuICAgIH0pO1xuICAgIHJvb3QucXVlcnlTZWxlY3RvckFsbCgnW2RhdGEtaTE4bi1hdHRyXScpLmZvckVhY2goZWwgPT4ge1xuICAgICAgICBjb25zdCBzcGVjID0gZWwuZ2V0QXR0cmlidXRlKCdkYXRhLWkxOG4tYXR0cicpO1xuICAgICAgICBpZiAoIXNwZWMpXG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIGZvciAoY29uc3QgcGFpciBvZiBzcGVjLnNwbGl0KCc7JykpIHtcbiAgICAgICAgICAgIGNvbnN0IFthdHRyLCBrZXldID0gcGFpci5zcGxpdCgnOicpLm1hcChzID0+IHM/LnRyaW0oKSk7XG4gICAgICAgICAgICBpZiAoYXR0ciAmJiBrZXkpXG4gICAgICAgICAgICAgICAgZWwuc2V0QXR0cmlidXRlKGF0dHIsIGdldChrZXkpKTtcbiAgICAgICAgfVxuICAgIH0pO1xufVxuZXhwb3J0IGRlZmF1bHQgaTE4bjtcbiIsImNvbnN0IFAyQyA9IHtcbiAgICBQSU5HOiAnUElORycsXG4gICAgVE9HR0xFX1NFTEVDVDogJ1RPR0dMRV9TRUxFQ1QnLFxuICAgIFJFTkRFUjogJ1JFTkRFUicsXG4gICAgQ0xFQVI6ICdDTEVBUicsXG4gICAgR0VUX1NUQVRFOiAnR0VUX1NUQVRFJyxcbn07XG5jb25zdCBDMlAgPSB7XG4gICAgU0VMRUNURUQ6ICdTRUxFQ1RFRCcsXG59O1xuZXhwb3J0IGNvbnN0IE1TR19UWVBFID0geyAuLi5QMkMsIC4uLkMyUCB9O1xuZXhwb3J0IGZ1bmN0aW9uIGlzUmVzcG9uc2UobXNnKSB7XG4gICAgcmV0dXJuIHR5cGVvZiBtc2cgPT09ICdvYmplY3QnICYmIG1zZyAhPT0gbnVsbCAmJiAnaWQnIGluIG1zZyAmJiAnb2snIGluIG1zZztcbn1cbiIsIi8qKlxuICogQnVpbGRzIGEgcGFnZSBrZXkgZnJvbSBhIFVSTC4gQnkgZGVmYXVsdCBleGNsdWRlcyB0aGUgaGFzaCBhbmQgdXNlc1xuICogb3JpZ2luICsgcGF0aG5hbWUgKyBzZWFyY2guXG4gKlxuICogQHBhcmFtIHVybCAtIElucHV0IFVSTCAocmV0dXJuZWQgYXMtaXMgaWYgaW52YWxpZClcbiAqIEBwYXJhbSBpbmNsdWRlSGFzaCAtIFdoZXRoZXIgdG8gaW5jbHVkZSB0aGUgaGFzaCAoZGVmYXVsdDogZmFsc2UpXG4gKiBAcmV0dXJucyBQYWdlIGtleSBzdHJpbmdcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHBhZ2VLZXkodXJsLCBpbmNsdWRlSGFzaCA9IGZhbHNlKSB7XG4gICAgdHJ5IHtcbiAgICAgICAgY29uc3QgdSA9IG5ldyBVUkwodXJsKTtcbiAgICAgICAgcmV0dXJuIGluY2x1ZGVIYXNoXG4gICAgICAgICAgICA/IGAke3Uub3JpZ2lufSR7dS5wYXRobmFtZX0ke3Uuc2VhcmNofSR7dS5oYXNofWBcbiAgICAgICAgICAgIDogYCR7dS5vcmlnaW59JHt1LnBhdGhuYW1lfSR7dS5zZWFyY2h9YDtcbiAgICB9XG4gICAgY2F0Y2gge1xuICAgICAgICByZXR1cm4gdXJsO1xuICAgIH1cbn1cbi8qKlxuICogQ2hlY2tzIGlmIGEgVVJMIGlzIHJlc3RyaWN0ZWQgb3Igc2hvdWxkIG5vdCBiZSBvcGVyYXRlZCBieSB0aGUgZXh0ZW5zaW9uLlxuICogRXhhbXBsZXM6IGNocm9tZTovLywgZWRnZTovLywgYWJvdXQ6LCBtb3otZXh0ZW5zaW9uOi8vXG4gKlxuICogQHBhcmFtIHVybCAtIFVSTCB0byBjaGVja1xuICogQHJldHVybnMgVHJ1ZSBpZiB0aGUgVVJMIGlzIHJlc3RyaWN0ZWRcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGlzUmVzdHJpY3RlZCh1cmwpIHtcbiAgICByZXR1cm4gIXVybFxuICAgICAgICB8fCB1cmwuc3RhcnRzV2l0aCgnY2hyb21lOi8vJylcbiAgICAgICAgfHwgdXJsLnN0YXJ0c1dpdGgoJ2VkZ2U6Ly8nKVxuICAgICAgICB8fCB1cmwuc3RhcnRzV2l0aCgnYWJvdXQ6JylcbiAgICAgICAgfHwgdXJsLnN0YXJ0c1dpdGgoJ21vei1leHRlbnNpb246Ly8nKTtcbn1cbiIsImV4cG9ydCBjb25zdCBQUk9UT0NPTF9WRVJTSU9OID0gMTtcbmV4cG9ydCBjb25zdCBDSEFOTkVMID0ge1xuICAgIFBBTkVMX0NPTlRFTlQ6IGBzcHNrOnBhbmVsLWNvbnRlbnQ6diR7UFJPVE9DT0xfVkVSU0lPTn1gLFxufTtcbi8qKlxuICogQ2hlY2tzIHdoZXRoZXIgdGhlIGdpdmVuIFBvcnQubmFtZSBtYXRjaGVzIHRoZSBzcGVjaWZpZWQgY2hhbm5lbC5cbiAqIFVzZSB0aGlzIHRvIHNhZmVseSBkaXN0aW5ndWlzaCBjb25uZWN0aW9uIHR5cGVzIGJldHdlZW4gUGFuZWwgYW5kIENvbnRlbnQuXG4gKlxuICogQHBhcmFtIHBvcnQgLSBBIGNvbm5lY3RlZCBydW50aW1lLlBvcnRcbiAqIEBwYXJhbSBuYW1lIC0gVGFyZ2V0IGNoYW5uZWwgbmFtZSB0byBjb21wYXJlXG4gKiBAcmV0dXJucyBUcnVlIGlmIHRoZSBwb3J0IGJlbG9uZ3MgdG8gdGhlIGNoYW5uZWxcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGlzQ2hhbm5lbChwb3J0LCBuYW1lKSB7XG4gICAgcmV0dXJuIHBvcnQubmFtZSA9PT0gbmFtZTtcbn1cbi8qKlxuICogRGV0ZXJtaW5lcyB3aGV0aGVyIHRoZSBwb3J0IGlzIHVzZWQgZm9yIFBhbmVsIOKGlCBDb250ZW50IGNvbW11bmljYXRpb24uXG4gKiBBIGNvbnZlbmllbmNlIHdyYXBwZXIgZm9yIENIQU5ORUwuUEFORUxfQ09OVEVOVC5cbiAqXG4gKiBAcGFyYW0gcG9ydCAtIEEgY29ubmVjdGVkIHJ1bnRpbWUuUG9ydFxuICogQHJldHVybnMgVHJ1ZSBpZiB0aGUgcG9ydCBpcyB0aGUgUGFuZWzigJNDb250ZW50IGNoYW5uZWxcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGlzUGFuZWxDb250ZW50UG9ydChwb3J0KSB7XG4gICAgcmV0dXJuIGlzQ2hhbm5lbChwb3J0LCBDSEFOTkVMLlBBTkVMX0NPTlRFTlQpO1xufVxuIiwiaW1wb3J0IHsgTVNHX1RZUEUgfSBmcm9tICdAY29tbW9uL21lc3NhZ2VzJztcbi8qKlxuICogVGhpbiBSUEMgd3JhcHBlciBmb3Igc2VuZGluZyBtZXNzYWdlcyBmcm9tIFBhbmVsIHRvIENvbnRlbnQuXG4gKiBFeHBvc2VzIGhpZ2gtbGV2ZWwgbWV0aG9kcyBmb3IgZWFjaCBtZXNzYWdlIHR5cGUuXG4gKi9cbmV4cG9ydCBjbGFzcyBQYW5lbEFwaSB7XG4gICAgcnBjO1xuICAgIGNvbnN0cnVjdG9yKHJwYykge1xuICAgICAgICB0aGlzLnJwYyA9IHJwYztcbiAgICB9XG4gICAgLyoqXG4gICAgICogSW50ZXJuYWwgc2VuZCBoZWxwZXIgdGhhdCBhdHRhY2hlcyBhbiBSUEMgcmVxdWVzdCBpZCBhcyBuZWVkZWQuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gYm9keSAtIE1lc3NhZ2UgcGF5bG9hZCB0byBzZW5kXG4gICAgICogQHJldHVybnMgVm9pZC1saWtlIHdoZW4gbm8gcmVwbHkgaXMgZXhwZWN0ZWQ7IG90aGVyd2lzZSByZXNvbHZlcyB3aXRoIGEgcmVzcG9uc2VcbiAgICAgKi9cbiAgICBzZW5kKGJvZHkpIHtcbiAgICAgICAgY29uc3QgcmVxID0ge1xuICAgICAgICAgICAgaWQ6IGNyeXB0by5yYW5kb21VVUlEKCksXG4gICAgICAgICAgICBleHBlY3RSZXBseTogZmFsc2UsXG4gICAgICAgICAgICAuLi5ib2R5XG4gICAgICAgIH07XG4gICAgICAgIHJldHVybiB0aGlzLnJwYy5zZW5kKHJlcSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJlcXVlc3RzIENvbnRlbnQgdG8gcmVuZGVyIHRoZSBnaXZlbiBpdGVtcy5cbiAgICAgKiBAcGFyYW0gaXRlbXMgLSBJdGVtcyB0byBkcmF3XG4gICAgICovXG4gICAgcmVuZGVyKGl0ZW1zKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnNlbmQoeyB0eXBlOiBNU0dfVFlQRS5SRU5ERVIsIHBheWxvYWQ6IHsgaXRlbXMgfSB9KTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogVG9nZ2xlcyBzZWxlY3Rpb24gbW9kZSBpbiBDb250ZW50LlxuICAgICAqIEBwYXJhbSBlbmFibGVkIC0gVHJ1ZSB0byBlbmFibGVcbiAgICAgKi9cbiAgICB0b2dnbGVTZWxlY3QoZW5hYmxlZCkge1xuICAgICAgICByZXR1cm4gdGhpcy5zZW5kKHsgdHlwZTogTVNHX1RZUEUuVE9HR0xFX1NFTEVDVCwgcGF5bG9hZDogeyBlbmFibGVkIH0gfSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENsZWFycyB0aGUgQ29udGVudCBvdmVybGF5LlxuICAgICAqL1xuICAgIGNsZWFyKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5zZW5kKHsgdHlwZTogTVNHX1RZUEUuQ0xFQVIgfSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFBlcmZvcm1zIGEgY29ubmVjdGl2aXR5IGhlYWx0aCBjaGVjayAocm91bmQtdHJpcCkuXG4gICAgICogU2VudCBhcyBhIHJlcXVlc3QgZXhwZWN0aW5nIGEgcmVwbHkuXG4gICAgICpcbiAgICAgKiBAcmV0dXJucyBUaGUgcmVzcG9uc2UsIG9yIHVuZGVmaW5lZCBvbiB0aW1lb3V0XG4gICAgICovXG4gICAgcGluZygpIHtcbiAgICAgICAgY29uc3QgcmVxID0ge1xuICAgICAgICAgICAgaWQ6IGNyeXB0by5yYW5kb21VVUlEKCksXG4gICAgICAgICAgICBleHBlY3RSZXBseTogdHJ1ZSxcbiAgICAgICAgICAgIHR5cGU6IE1TR19UWVBFLlBJTkdcbiAgICAgICAgfTtcbiAgICAgICAgcmV0dXJuIHRoaXMucnBjLnNlbmQocmVxLCA1MDAwKTtcbiAgICB9XG59XG4iLCJpbXBvcnQgeyBpc1Jlc3BvbnNlIH0gZnJvbSAnQGNvbW1vbi9tZXNzYWdlcyc7XG4vKipcbiAqIEltcGxlbWVudHMgYSBtaW5pbWFsIHJlcXVlc3QvcmVzcG9uc2UgUlBDIG92ZXIgY2hyb21lLnJ1bnRpbWUuUG9ydC5cbiAqIFRyYWNrcyBwZW5kaW5nIHJlcXVlc3RzIGJ5IGlkIGFuZCBoYW5kbGVzIHRpbWVvdXRzIGFuZCBkaXNjb25uZWN0cy5cbiAqL1xuZXhwb3J0IGNsYXNzIFBvcnRScGMge1xuICAgIHBvcnQ7XG4gICAgcGVuZGluZyA9IG5ldyBNYXAoKTtcbiAgICAvKipcbiAgICAgKiBTdWJzY3JpYmVzIHRvIHBvcnQgbWVzc2FnZSBhbmQgZGlzY29ubmVjdCBldmVudHMuXG4gICAgICogQHBhcmFtIHBvcnQgLSBUaGUgcnVudGltZS5Qb3J0IHVzZWQgZm9yIG1lc3NhZ2luZ1xuICAgICAqL1xuICAgIGNvbnN0cnVjdG9yKHBvcnQpIHtcbiAgICAgICAgdGhpcy5wb3J0ID0gcG9ydDtcbiAgICAgICAgdGhpcy5wb3J0Lm9uTWVzc2FnZS5hZGRMaXN0ZW5lcigobXNnKSA9PiB7XG4gICAgICAgICAgICBpZiAoaXNSZXNwb25zZShtc2cpKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5wZW5kaW5nLmdldChtc2cuaWQpPy4obXNnKTtcbiAgICAgICAgICAgICAgICB0aGlzLnBlbmRpbmcuZGVsZXRlKG1zZy5pZCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLnBvcnQub25EaXNjb25uZWN0LmFkZExpc3RlbmVyKCgpID0+IHtcbiAgICAgICAgICAgIC8vIFRyZWF0IHBlbmRpbmcgc3RhdHVzIGFzIGZhaWx1cmUgd2hlbiBhIGRpc2Nvbm5lY3Rpb24gb2NjdXJzLlxuICAgICAgICAgICAgZm9yIChjb25zdCBbLCByZXNvbHZlXSBvZiB0aGlzLnBlbmRpbmcpXG4gICAgICAgICAgICAgICAgcmVzb2x2ZSh7IGlkOiAnJywgb2s6IGZhbHNlLCBlcnJvcjogJ2Rpc2Nvbm5lY3RlZCcgfSk7XG4gICAgICAgICAgICB0aGlzLnBlbmRpbmcuY2xlYXIoKTtcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFNlbmRzIGFuIFJQQyByZXF1ZXN0IGFuZCBvcHRpb25hbGx5IGF3YWl0cyBhIHJlc3BvbnNlLlxuICAgICAqXG4gICAgICogQHBhcmFtIHJlcSAtIFRoZSBSUEMgcmVxdWVzdCB0byBzZW5kXG4gICAgICogQHBhcmFtIHRpbWVvdXRNcyAtIFRpbWVvdXQgKG1zKSB3aGVuIHdhaXRpbmcgZm9yIGEgcmVwbHkgKGRlZmF1bHQgNTAwMClcbiAgICAgKiBAcmV0dXJucyBUaGUgcmVzcG9uc2Ugd2hlbiBgZXhwZWN0UmVwbHlgIGlzIHRydWU7IG90aGVyd2lzZSB1bmRlZmluZWRcbiAgICAgKi9cbiAgICBzZW5kKHJlcSwgdGltZW91dE1zID0gNTAwMCkge1xuICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUpID0+IHtcbiAgICAgICAgICAgIGlmIChyZXEuZXhwZWN0UmVwbHkpIHtcbiAgICAgICAgICAgICAgICBjb25zdCB0aW1lciA9IHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnBlbmRpbmcuZGVsZXRlKHJlcS5pZCk7XG4gICAgICAgICAgICAgICAgICAgIHJlc29sdmUodW5kZWZpbmVkKTtcbiAgICAgICAgICAgICAgICB9LCB0aW1lb3V0TXMpO1xuICAgICAgICAgICAgICAgIHRoaXMucGVuZGluZy5zZXQocmVxLmlkLCAocmVzKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGNsZWFyVGltZW91dCh0aW1lcik7XG4gICAgICAgICAgICAgICAgICAgIHJlc29sdmUocmVzKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMucG9ydC5wb3N0TWVzc2FnZShyZXEpO1xuICAgICAgICAgICAgaWYgKCFyZXEuZXhwZWN0UmVwbHkpXG4gICAgICAgICAgICAgICAgcmVzb2x2ZSh1bmRlZmluZWQpO1xuICAgICAgICB9KTtcbiAgICB9XG59XG4iLCJleHBvcnQgY29uc3QgQ0RQX1ZFUlNJT04gPSAnMS4zJztcbi8qKlxuICogV3JhcHMgYGNocm9tZS5ydW50aW1lLmxhc3RFcnJvcmAgaW50byBhIHN0YW5kYXJkIGBFcnJvcmAgaW5zdGFuY2UuXG4gKlxuICogQHJldHVybnMgQW4gYEVycm9yYCB3aGVuIGEgbGFzdEVycm9yIGV4aXN0czsgb3RoZXJ3aXNlIGBudWxsYC5cbiAqL1xuZnVuY3Rpb24gbGFzdEVycm9yKCkge1xuICAgIGNvbnN0IGVyciA9IGNocm9tZS5ydW50aW1lLmxhc3RFcnJvcjtcbiAgICByZXR1cm4gZXJyID8gbmV3IEVycm9yKGVyci5tZXNzYWdlIHx8IFN0cmluZyhlcnIpKSA6IG51bGw7XG59XG4vKipcbiAqIEF0dGFjaGVzIHRoZSBDaHJvbWUgRGVidWdnZXIgKENEUCkgdG8gdGhlIGdpdmVuIHRhcmdldC5cbiAqXG4gKiBAcGFyYW0gdGFyZ2V0IC0gVGhlIGRlYnVnZ2VlIChlLmcuLCBgeyB0YWJJZCB9YCkgdG8gYXR0YWNoIHRvLlxuICogQHJldHVybnMgQSBwcm9taXNlIHRoYXQgcmVzb2x2ZXMgd2hlbiB0aGUgZGVidWdnZXIgaXMgYXR0YWNoZWQsIG9yIHJlamVjdHMgb24gZXJyb3IuXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBhdHRhY2godGFyZ2V0KSB7XG4gICAgYXdhaXQgbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgICAgICBjaHJvbWUuZGVidWdnZXIuYXR0YWNoKHRhcmdldCwgQ0RQX1ZFUlNJT04sICgpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGVyciA9IGxhc3RFcnJvcigpO1xuICAgICAgICAgICAgaWYgKGVycikge1xuICAgICAgICAgICAgICAgIHJlamVjdChlcnIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgcmVzb2x2ZSgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9KTtcbn1cbi8qKlxuICogRGV0YWNoZXMgdGhlIENocm9tZSBEZWJ1Z2dlciAoQ0RQKSBmcm9tIHRoZSBnaXZlbiB0YXJnZXQuXG4gKlxuICogQHBhcmFtIHRhcmdldCAtIFRoZSBkZWJ1Z2dlZSB0byBkZXRhY2ggZnJvbS5cbiAqIEByZXR1cm5zIEEgcHJvbWlzZSB0aGF0IHJlc29sdmVzIG9uY2UgZGV0YWNobWVudCBjb21wbGV0ZXMuXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBkZXRhY2godGFyZ2V0KSB7XG4gICAgYXdhaXQgbmV3IFByb21pc2UoKHJlc29sdmUpID0+IHtcbiAgICAgICAgY2hyb21lLmRlYnVnZ2VyLmRldGFjaCh0YXJnZXQsICgpID0+IHJlc29sdmUoKSk7XG4gICAgfSk7XG59XG4vKipcbiAqIFNlbmRzIGEgQ0RQIGNvbW1hbmQgdG8gdGhlIGF0dGFjaGVkIHRhcmdldC5cbiAqXG4gKiBAdHlwZVBhcmFtIFQgLSBFeHBlY3RlZCByZXN1bHQgdHlwZSBvZiB0aGUgY29tbWFuZC5cbiAqIEBwYXJhbSB0YXJnZXQgLSBUaGUgZGVidWdnZWUgdG8gd2hpY2ggdGhlIGNvbW1hbmQgaXMgc2VudC5cbiAqIEBwYXJhbSBtZXRob2QgLSBDRFAgbWV0aG9kIG5hbWUgKGUuZy4sIGAnUGFnZS5jYXB0dXJlU2NyZWVuc2hvdCdgKS5cbiAqIEBwYXJhbSBwYXJhbXMgLSBPcHRpb25hbCBwYXJhbWV0ZXJzIG9iamVjdCBmb3IgdGhlIGNvbW1hbmQuXG4gKiBAcmV0dXJucyBBIHByb21pc2UgdGhhdCByZXNvbHZlcyB3aXRoIHRoZSBjb21tYW5kIHJlc3VsdCBvciByZWplY3RzIGlmIGFuIGVycm9yIG9jY3Vycy5cbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHNlbmQodGFyZ2V0LCBtZXRob2QsIHBhcmFtcykge1xuICAgIHJldHVybiBhd2FpdCBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgICAgIGNocm9tZS5kZWJ1Z2dlci5zZW5kQ29tbWFuZCh0YXJnZXQsIG1ldGhvZCwgcGFyYW1zID8/IHt9LCAocmVzdWx0KSA9PiB7XG4gICAgICAgICAgICBjb25zdCBlcnIgPSBsYXN0RXJyb3IoKTtcbiAgICAgICAgICAgIGlmIChlcnIpIHtcbiAgICAgICAgICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHJlc29sdmUoKHJlc3VsdCA/PyB7fSkpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9KTtcbn1cbiIsImNvbnN0IFJPT1RfS0VZID0gJ3NjcmVlblN0YXRlQnlQYWdlJztcbi8qKlxuICogTG9hZHMgdGhlIGVudGlyZSBzdGF0ZSBtYXAgZnJvbSBjaHJvbWUuc3RvcmFnZS5sb2NhbCB1bmRlciBST09UX0tFWS5cbiAqXG4gKiBAcmV0dXJucyBQcm9taXNlIHJlc29sdmluZyB0byB0aGUgZnVsbCBzdGF0ZSBtYXA7IHJldHVybnMgYW4gZW1wdHkgb2JqZWN0IHdoZW4gbm90aGluZyBpcyBzdG9yZWQuXG4gKiBAcmVtYXJrcyBUaGlzIHBlcmZvcm1zIHN0b3JhZ2UgSS9PLlxuICovXG5hc3luYyBmdW5jdGlvbiByZWFkQWxsKCkge1xuICAgIGNvbnN0IHJhdyA9IGF3YWl0IGNocm9tZS5zdG9yYWdlLmxvY2FsLmdldChST09UX0tFWSk7XG4gICAgcmV0dXJuIHJhd1tST09UX0tFWV0gPz8ge307XG59XG4vKipcbiAqIFBlcnNpc3RzIHRoZSBlbnRpcmUgc3RhdGUgbWFwIHRvIGNocm9tZS5zdG9yYWdlLmxvY2FsIHVuZGVyIFJPT1RfS0VZLlxuICpcbiAqIEBwYXJhbSBtYXAgLSBUaGUgY29tcGxldGUgc3RhdGUgbWFwIHRvIHdyaXRlLlxuICogQHJldHVybnMgUHJvbWlzZSB0aGF0IHJlc29sdmVzIHdoZW4gdGhlIHdyaXRlIGNvbXBsZXRlcy5cbiAqIEByZW1hcmtzIFRoaXMgb3ZlcndyaXRlcyB0aGUgc3RvcmVkIG1hcCBmb3IgUk9PVF9LRVkuXG4gKi9cbmFzeW5jIGZ1bmN0aW9uIHdyaXRlQWxsKG1hcCkge1xuICAgIGF3YWl0IGNocm9tZS5zdG9yYWdlLmxvY2FsLnNldCh7IFtST09UX0tFWV06IG1hcCB9KTtcbn1cbi8qKlxuICogUmV0cmlldmVzIHRoZSBzdGF0ZSBib3VuZCB0byBhIHBhZ2Uga2V5LlxuICogUmV0dXJucyB0aGUgaW5pdGlhbCBkZWZhdWx0IHdoZW4gdGhlIGtleSBoYXMgbm8gc3RvcmVkIHN0YXRlLlxuICpcbiAqIEBwYXJhbSBwYWdlS2V5IC0gUGFnZSBrZXkgdGhhdCBpZGVudGlmaWVzIHRoZSBwYWdlIHN0YXRlIGJ1Y2tldC5cbiAqIEByZXR1cm5zIFByb21pc2UgcmVzb2x2aW5nIHRvIHRoZSBjb3JyZXNwb25kaW5nIFNjcmVlblN0YXRlLlxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0U3RhdGUocGFnZUtleSkge1xuICAgIGNvbnN0IG1hcCA9IGF3YWl0IHJlYWRBbGwoKTtcbiAgICByZXR1cm4gbWFwW3BhZ2VLZXldID8/IHsgaXRlbXM6IFtdLCBuZXh0SWQ6IDEsIG5leHRMYWJlbDogMSB9O1xufVxuLyoqXG4gKiBTdG9yZXMgdGhlIGdpdmVuIHN0YXRlIHVuZGVyIHRoZSBzcGVjaWZpZWQgcGFnZSBrZXkuXG4gKlxuICogQHBhcmFtIHBhZ2VLZXlTdHIgLSBQYWdlIGtleSB0byBhc3NvY2lhdGUgd2l0aCB0aGUgc3RhdGUuXG4gKiBAcGFyYW0gc3RhdGUgLSBUaGUgU2NyZWVuU3RhdGUgdG8gcGVyc2lzdC5cbiAqIEByZXR1cm5zIFByb21pc2UgdGhhdCByZXNvbHZlcyB3aGVuIHRoZSB3cml0ZSBjb21wbGV0ZXMuXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBzZXRTdGF0ZShwYWdlS2V5U3RyLCBzdGF0ZSkge1xuICAgIGNvbnN0IG1hcCA9IGF3YWl0IHJlYWRBbGwoKTtcbiAgICBtYXBbcGFnZUtleVN0cl0gPSBzdGF0ZTtcbiAgICBhd2FpdCB3cml0ZUFsbChtYXApO1xufVxuLyoqXG4gKiBSZWFzc2lnbnMgbGFiZWxzIHNlcXVlbnRpYWxseSAoMS4ubikgYWNjb3JkaW5nIHRvIHRoZSBjdXJyZW50IGFycmF5IG9yZGVyLlxuICpcbiAqIEBwYXJhbSBzdGF0ZSAtIFRoZSBzdGF0ZSB3aG9zZSBpdGVtcyBzaG91bGQgYmUgcmVsYWJlbGVkIGluLXBsYWNlLlxuICogQHJlbWFya3MgQWxzbyB1cGRhdGVzIGBuZXh0TGFiZWxgIHRvIGBpdGVtcy5sZW5ndGggKyAxYC5cbiAqL1xuZnVuY3Rpb24gcmVsYWJlbFNlcXVlbnRpYWwoc3RhdGUpIHtcbiAgICBzdGF0ZS5pdGVtcy5mb3JFYWNoKChpdCwgaSkgPT4ge1xuICAgICAgICBpdC5sYWJlbCA9IGkgKyAxO1xuICAgIH0pO1xuICAgIHN0YXRlLm5leHRMYWJlbCA9IHN0YXRlLml0ZW1zLmxlbmd0aCArIDE7XG59XG4vKipcbiAqIEFwcGxpZXMgYSBwYXRjaCAoYWRkL3VwZGF0ZS9yZW1vdmUpIHRvIHRoZSBzdGF0ZSBmb3IgdGhlIGdpdmVuIHBhZ2Uga2V5LFxuICogcmVsYWJlbHMgc2VxdWVudGlhbGx5IGlmIGFueSByZW1vdmFsIG9jY3VycmVkLCBwZXJzaXN0cyB0aGUgcmVzdWx0LFxuICogYW5kIHJldHVybnMgdGhlIHVwZGF0ZWQgc3RhdGUuXG4gKlxuICogQHBhcmFtIHBhZ2VLZXlTdHIgLSBQYWdlIGtleSBvZiB0aGUgc3RhdGUgdG8gbW9kaWZ5LlxuICogQHBhcmFtIHBhdGNoIC0gQ2hhbmdlcyB0byBhcHBseSB0byB0aGUgc3RhdGUuXG4gKiBAcmV0dXJucyBQcm9taXNlIHJlc29sdmluZyB0byB0aGUgdXBkYXRlZCBTY3JlZW5TdGF0ZS5cbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGFwcGx5UGF0Y2gocGFnZUtleVN0ciwgcGF0Y2gpIHtcbiAgICBjb25zdCBzdGF0ZSA9IGF3YWl0IGdldFN0YXRlKHBhZ2VLZXlTdHIpO1xuICAgIGNvbnN0IGhhc1JlbW92YWwgPSAhIShwYXRjaC5yZW1vdmVkSWRzICYmIHBhdGNoLnJlbW92ZWRJZHMubGVuZ3RoKTtcbiAgICBpZiAocGF0Y2gucmVtb3ZlZElkcz8ubGVuZ3RoKSB7XG4gICAgICAgIGNvbnN0IHRvUmVtb3ZlID0gbmV3IFNldChwYXRjaC5yZW1vdmVkSWRzKTtcbiAgICAgICAgc3RhdGUuaXRlbXMgPSBzdGF0ZS5pdGVtcy5maWx0ZXIoKGl0KSA9PiAhdG9SZW1vdmUuaGFzKGl0LmlkKSk7XG4gICAgfVxuICAgIGlmIChwYXRjaC51cGRhdGVkPy5sZW5ndGgpIHtcbiAgICAgICAgY29uc3QgbWFwID0gbmV3IE1hcChzdGF0ZS5pdGVtcy5tYXAoKGkpID0+IFtpLmlkLCBpXSkpO1xuICAgICAgICBmb3IgKGNvbnN0IHUgb2YgcGF0Y2gudXBkYXRlZCkge1xuICAgICAgICAgICAgY29uc3QgaXQgPSBtYXAuZ2V0KHUuaWQpO1xuICAgICAgICAgICAgaWYgKCFpdClcbiAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgIGlmICh0eXBlb2YgdS5sYWJlbCA9PT0gJ251bWJlcicpXG4gICAgICAgICAgICAgICAgaXQubGFiZWwgPSB1LmxhYmVsO1xuICAgICAgICAgICAgaWYgKHUuYW5jaG9yKVxuICAgICAgICAgICAgICAgIGl0LmFuY2hvciA9IHUuYW5jaG9yO1xuICAgICAgICAgICAgaWYgKHUubWV0YSlcbiAgICAgICAgICAgICAgICBpdC5tZXRhID0gdS5tZXRhO1xuICAgICAgICB9XG4gICAgfVxuICAgIGlmIChwYXRjaC5hZGRlZD8ubGVuZ3RoKSB7XG4gICAgICAgIGZvciAoY29uc3QgYSBvZiBwYXRjaC5hZGRlZCkge1xuICAgICAgICAgICAgY29uc3QgaWQgPSBzdGF0ZS5uZXh0SWQrKztcbiAgICAgICAgICAgIGNvbnN0IGxhYmVsID0gdHlwZW9mIGEubGFiZWwgPT09ICdudW1iZXInID8gYS5sYWJlbCA6IHN0YXRlLm5leHRMYWJlbCsrO1xuICAgICAgICAgICAgY29uc3QgaXQgPSB7XG4gICAgICAgICAgICAgICAgaWQsXG4gICAgICAgICAgICAgICAgbGFiZWwsXG4gICAgICAgICAgICAgICAgYW5jaG9yOiBhLmFuY2hvcixcbiAgICAgICAgICAgICAgICAuLi4oYS5tZXRhID8geyBtZXRhOiBhLm1ldGEgfSA6IHt9KSxcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICBzdGF0ZS5pdGVtcy5wdXNoKGl0KTtcbiAgICAgICAgfVxuICAgIH1cbiAgICAvLyBJZiBhdCBsZWFzdCBvbmUgaXRlbSBpcyBkZWxldGVkLCByZWxhYmVsIGZyb20gMSB0byBuIGluIHRoZSBjdXJyZW50IGFycmF5IG9yZGVyLlxuICAgIGlmIChoYXNSZW1vdmFsKSB7XG4gICAgICAgIHJlbGFiZWxTZXF1ZW50aWFsKHN0YXRlKTtcbiAgICB9XG4gICAgYXdhaXQgc2V0U3RhdGUocGFnZUtleVN0ciwgc3RhdGUpO1xuICAgIHJldHVybiBzdGF0ZTtcbn1cbi8qKlxuICogVG9nZ2xlcyBzZWxlY3Rpb24gZm9yIHRoZSBnaXZlbiBhbmNob3JzIChmcm9tIENvbnRlbnQpOiBpZiBhbiBhbmNob3IgYWxyZWFkeVxuICogZXhpc3RzLCByZW1vdmUgaXQ7IG90aGVyd2lzZSBhZGQgaXQuIERlZHVwZSBpbmNvbWluZyBhbmNob3JzIGJ5IGB2YWx1ZWAsXG4gKiBhcHBseSB0aGUgY29ycmVzcG9uZGluZyBwYXRjaCwgcGVyc2lzdCwgYW5kIHJldHVybiB0aGUgbGF0ZXN0IHN0YXRlLlxuICpcbiAqIEBwYXJhbSBwYWdlS2V5U3RyIC0gUGFnZSBrZXkgb2YgdGhlIHN0YXRlIHRvIHVwZGF0ZS5cbiAqIEBwYXJhbSBhbmNob3JzIC0gQW5jaG9ycyByZXBvcnRlZCBieSBDb250ZW50LlxuICogQHJldHVybnMgUHJvbWlzZSByZXNvbHZpbmcgdG8gdGhlIHVwZGF0ZWQgU2NyZWVuU3RhdGUuXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBoYW5kbGVTZWxlY3RlZChwYWdlS2V5U3RyLCBhbmNob3JzKSB7XG4gICAgY29uc3Qgc3RhdGUgPSBhd2FpdCBnZXRTdGF0ZShwYWdlS2V5U3RyKTtcbiAgICBjb25zdCB1bmlxID0gQXJyYXkuZnJvbShuZXcgU2V0KGFuY2hvcnMubWFwKChhKSA9PiBhLnZhbHVlKSkpXG4gICAgICAgIC5tYXAoKHYpID0+IGFuY2hvcnMuZmluZCgoYSkgPT4gYS52YWx1ZSA9PT0gdikpXG4gICAgICAgIC5maWx0ZXIoQm9vbGVhbik7XG4gICAgY29uc3QgcmVtb3ZlZElkcyA9IFtdO1xuICAgIGNvbnN0IHRvQWRkID0gW107XG4gICAgZm9yIChjb25zdCBhIG9mIHVuaXEpIHtcbiAgICAgICAgY29uc3QgZm91bmQgPSBzdGF0ZS5pdGVtcy5maW5kKChpdCkgPT4gaXQuYW5jaG9yLmtpbmQgPT09IGEua2luZCAmJiBpdC5hbmNob3IudmFsdWUgPT09IGEudmFsdWUpO1xuICAgICAgICBpZiAoZm91bmQpIHtcbiAgICAgICAgICAgIHJlbW92ZWRJZHMucHVzaChmb3VuZC5pZCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0b0FkZC5wdXNoKHsgYW5jaG9yOiBhIH0pO1xuICAgICAgICB9XG4gICAgfVxuICAgIGNvbnN0IHBhdGNoID0ge307XG4gICAgaWYgKHJlbW92ZWRJZHMubGVuZ3RoKVxuICAgICAgICBwYXRjaC5yZW1vdmVkSWRzID0gcmVtb3ZlZElkcztcbiAgICBpZiAodG9BZGQubGVuZ3RoKVxuICAgICAgICBwYXRjaC5hZGRlZCA9IHRvQWRkO1xuICAgIHJldHVybiBhcHBseVBhdGNoKHBhZ2VLZXlTdHIsIHBhdGNoKTtcbn1cbiIsImltcG9ydCBpMThuIGZyb20gJ0Bjb21tb24vaTE4bic7XG5leHBvcnQgY29uc3QgU1RBVFVTID0ge1xuICAgIFJFU1RSSUNURUQ6ICdSRVNUUklDVEVEJyxcbiAgICBDT05ORUNUSU5HOiAnQ09OTkVDVElORycsXG4gICAgQ09OTkVDVEVEOiAnQ09OTkVDVEVEJyxcbiAgICBESVNDT05ORUNURUQ6ICdESVNDT05ORUNURUQnLFxufTtcbmNvbnN0IFNUQVRVU19NU0dfS0VZID0ge1xuICAgIFJFU1RSSUNURUQ6ICdzdGF0dXNfcmVzdHJpY3RlZCcsXG4gICAgQ09OTkVDVElORzogJ3N0YXR1c19jb25uZWN0aW5nJyxcbiAgICBDT05ORUNURUQ6ICdzdGF0dXNfY29ubmVjdGVkJyxcbiAgICBESVNDT05ORUNURUQ6ICdzdGF0dXNfZGlzY29ubmVjdGVkJyxcbn07XG5leHBvcnQgY29uc3QgU1RBVFVTX0xBQkVMX1NUWUxFID0ge1xuICAgIFJFU1RSSUNURUQ6IHtcbiAgICAgICAgYm9keTogW1xuICAgICAgICAgICAgJ2JnLWFtYmVyLTUwJywgJ2JvcmRlci1hbWJlci0yMDAnLCAndGV4dC1hbWJlci03MDAnLFxuICAgICAgICAgICAgJ2Rhcms6YmctYW1iZXItOTUwJywgJ2Rhcms6Ym9yZGVyLWFtYmVyLTkwMC81MCcsICdkYXJrOnRleHQtYW1iZXItMzAwJyxcbiAgICAgICAgXSxcbiAgICAgICAgZG90OiBbJ2JnLWFtYmVyLTUwMCddXG4gICAgfSxcbiAgICBDT05ORUNUSU5HOiB7XG4gICAgICAgIGJvZHk6IFtcbiAgICAgICAgICAgICdiZy1za3ktNTAnLCAnYm9yZGVyLXNreS0yMDAnLCAndGV4dC1za3ktNzAwJyxcbiAgICAgICAgICAgICdkYXJrOmJnLXNreS05NTAnLCAnZGFyazpib3JkZXItc2t5LTkwMC81MCcsICdkYXJrOnRleHQtc2t5LTMwMCcsXG4gICAgICAgIF0sXG4gICAgICAgIGRvdDogWydiZy1za3ktNTAwJ11cbiAgICB9LFxuICAgIENPTk5FQ1RFRDoge1xuICAgICAgICBib2R5OiBbXG4gICAgICAgICAgICAnYmctZW1lcmFsZC01MCcsICdib3JkZXItZW1lcmFsZC0yMDAnLCAndGV4dC1lbWVyYWxkLTcwMCcsXG4gICAgICAgICAgICAnZGFyazpiZy1lbWVyYWxkLTk1MCcsICdkYXJrOmJvcmRlci1lbWVyYWxkLTkwMC81MCcsICdkYXJrOnRleHQtZW1lcmFsZC0zMDAnLFxuICAgICAgICBdLFxuICAgICAgICBkb3Q6IFsnYmctZW1lcmFsZC01MDAnXVxuICAgIH0sXG4gICAgRElTQ09OTkVDVEVEOiB7XG4gICAgICAgIGJvZHk6IFtcbiAgICAgICAgICAgICdiZy1yb3NlLTUwJywgJ2JvcmRlci1yb3NlLTIwMCcsICd0ZXh0LXJvc2UtNzAwJyxcbiAgICAgICAgICAgICdkYXJrOmJnLXJvc2UtOTUwJywgJ2Rhcms6Ym9yZGVyLXJvc2UtOTAwLzUwJywgJ2Rhcms6dGV4dC1yb3NlLTMwMCcsXG4gICAgICAgIF0sXG4gICAgICAgIGRvdDogWydiZy1yb3NlLTUwMCddXG4gICAgfSxcbn07XG5leHBvcnQgZnVuY3Rpb24gZ2V0U3RhdHVzTWVzc2FnZShrZXkpIHtcbiAgICBjb25zdCBtc2dLZXkgPSBTVEFUVVNfTVNHX0tFWVtrZXldO1xuICAgIHJldHVybiBpMThuLmdldChtc2dLZXkpIHx8IG1zZ0tleTtcbn1cbiIsImltcG9ydCBpMThuIGZyb20gJ0Bjb21tb24vaTE4bic7XG5pbXBvcnQgeyBnZXRTdGF0dXNNZXNzYWdlLCBTVEFUVVNfTEFCRUxfU1RZTEUgfSBmcm9tICdAcGFuZWwvdmlldy9zdGF0dXMnO1xuY29uc3Qgc3RhdHVzRWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc3RhdHVzJyk7XG5jb25zdCB0b2dnbGVJY29uRWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndG9nZ2xlLXNlbGVjdC1pY29uJyk7XG5jb25zdCB0b2dnbGVMYWJlbEVsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3RvZ2dsZS1zZWxlY3QtbGFiZWwnKTtcbmNvbnN0IHNlbGVjdENvdW50RWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2VsZWN0LWNvdW50Jyk7XG5jb25zdCBzZWxlY3RFbXB0eUVsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3NlbGVjdC1lbXB0eScpO1xuY29uc3Qgc2VsZWN0TGlzdEVsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3NlbGVjdC1saXN0Jyk7XG5jb25zdCBTVEFUVVNfQkFTRV9CT0RZID0gW1xuICAgICdpbmxpbmUtZmxleCcsICdpdGVtcy1jZW50ZXInLCAnZ2FwLTEnLFxuICAgICdyb3VuZGVkLWZ1bGwnLCAnYm9yZGVyJywgJ3B4LTInLCAncHktMScsICd0ZXh0LXhzJyxcbiAgICAndHJhbnNpdGlvbi1jb2xvcnMnLFxuXTtcbmNvbnN0IFRPR0dMRV9JQ09OX0JBU0UgPSBbXG4gICAgJ2lubGluZS1ibG9jaycsICd3LTMnLCAnaC0zJywgJ3JvdW5kZWQtZnVsbCcsXG5dO1xuY29uc3QgVE9HR0xFX0lDT05fT04gPSBbJ2JnLWVtZXJhbGQtNTAwJ107XG5jb25zdCBUT0dHTEVfSUNPTl9PRkYgPSBbJ2JnLXNsYXRlLTMwMCddO1xuLyoqXG4gKiBVcGRhdGVzIHRoZSBjb25uZWN0aW9uIHN0YXR1cyBpbmRpY2F0b3IncyBzdHlsZSBhbmQgdGV4dC5cbiAqXG4gKiBAcGFyYW0ga2V5IC0gQ3VycmVudCBzdGF0dXMga2V5XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiB1cGRhdGVTdGF0dXNVSShrZXkpIHtcbiAgICBjb25zdCBzdHlsZSA9IFNUQVRVU19MQUJFTF9TVFlMRVtrZXldO1xuICAgIHN0YXR1c0VsLmNsYXNzTmFtZSA9ICcnO1xuICAgIHN0YXR1c0VsLmNsYXNzTGlzdC5hZGQoLi4uU1RBVFVTX0JBU0VfQk9EWSwgLi4uc3R5bGUuYm9keSk7XG4gICAgY29uc3QgZG90ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc3BhbicpO1xuICAgIGRvdC5jbGFzc0xpc3QuYWRkKCdoLTEuNScsICd3LTEuNScsICdyb3VuZGVkLWZ1bGwnLCAuLi5zdHlsZS5kb3QpO1xuICAgIGNvbnN0IHRleHQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzcGFuJyk7XG4gICAgdGV4dC50ZXh0Q29udGVudCA9IGdldFN0YXR1c01lc3NhZ2Uoa2V5KTtcbiAgICBzdGF0dXNFbC5yZXBsYWNlQ2hpbGRyZW4oZG90LCB0ZXh0KTtcbn1cbi8qKlxuICogVXBkYXRlcyB0aGUgc2VsZWN0aW9uIHRvZ2dsZSdzIGljb24gYW5kIGxhYmVsLlxuICpcbiAqIEBwYXJhbSBlbmFibGVkIC0gVHJ1ZSBpZiBzZWxlY3Rpb24gaXMgZW5hYmxlZFxuICovXG5leHBvcnQgZnVuY3Rpb24gdXBkYXRlVG9nZ2xlSWNvblVJKGVuYWJsZWQpIHtcbiAgICB0b2dnbGVJY29uRWwuY2xhc3NOYW1lID0gJyc7XG4gICAgdG9nZ2xlSWNvbkVsLmNsYXNzTGlzdC5hZGQoLi4uVE9HR0xFX0lDT05fQkFTRSwgLi4uKGVuYWJsZWQgPyBUT0dHTEVfSUNPTl9PTiA6IFRPR0dMRV9JQ09OX09GRikpO1xuICAgIHRvZ2dsZUxhYmVsRWwudGV4dENvbnRlbnQgPSBpMThuLmdldChlbmFibGVkID8gJ3RvZ2dsZV9vbicgOiAndG9nZ2xlX29mZicpO1xufVxuLyoqXG4gKiBSZWJ1aWxkcyB0aGUgc2VsZWN0aW9uIGxpc3QgVUkuIFNob3dzIGFuIGVtcHR5IHN0YXRlIHdoZW4gbm8gaXRlbXMgZXhpc3QuXG4gKlxuICogQHBhcmFtIGl0ZW1zIC0gSXRlbXMgdG8gZGlzcGxheVxuICovXG5leHBvcnQgZnVuY3Rpb24gcmVuZGVyTGlzdChpdGVtcykge1xuICAgIGNvbnN0IGlzRW1wdHkgPSBpdGVtcy5sZW5ndGggPT09IDA7XG4gICAgc2VsZWN0Q291bnRFbC50ZXh0Q29udGVudCA9IFN0cmluZyhpdGVtcy5sZW5ndGgpO1xuICAgIGlmIChpc0VtcHR5KSB7XG4gICAgICAgIHNlbGVjdEVtcHR5RWwuY2xhc3NMaXN0LnJlbW92ZSgnaGlkZGVuJyk7XG4gICAgICAgIHNlbGVjdExpc3RFbC5yZXBsYWNlQ2hpbGRyZW4oKTtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBzZWxlY3RFbXB0eUVsLmNsYXNzTGlzdC5hZGQoJ2hpZGRlbicpO1xuICAgIGNvbnN0IGZyYWcgPSBkb2N1bWVudC5jcmVhdGVEb2N1bWVudEZyYWdtZW50KCk7XG4gICAgZm9yIChjb25zdCBpdCBvZiBpdGVtcykge1xuICAgICAgICBjb25zdCBsaSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2xpJyk7XG4gICAgICAgIGxpLmNsYXNzTmFtZSA9ICdncm91cCBmbGV4IGl0ZW1zLWNlbnRlciBnYXAtMyBwLTMgaG92ZXI6Ymctc2xhdGUtNTAgZGFyazpob3ZlcjpiZy1zbGF0ZS04MDAvNjAnO1xuICAgICAgICBsaS5kYXRhc2V0LmlkID0gU3RyaW5nKGl0LmlkKTtcbiAgICAgICAgY29uc3QgYmFkZ2UgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzcGFuJyk7XG4gICAgICAgIGJhZGdlLmNsYXNzTmFtZSA9ICdpbmxpbmUtZmxleCBoLTYgdy02IGl0ZW1zLWNlbnRlciBqdXN0aWZ5LWNlbnRlciByb3VuZGVkLW1kIGJnLWluZGlnby02MDAvMTAgdGV4dC1pbmRpZ28tNzAwIGRhcms6dGV4dC1pbmRpZ28tMzAwIHRleHQteHMgZm9udC1zZW1pYm9sZCc7XG4gICAgICAgIGJhZGdlLnRleHRDb250ZW50ID0gU3RyaW5nKGl0LmxhYmVsKTtcbiAgICAgICAgY29uc3QgbWFpbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgICAgICBtYWluLmNsYXNzTmFtZSA9ICdtaW4tdy0wIGZsZXgtMSc7XG4gICAgICAgIGNvbnN0IGxpbmUxID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgICAgIGxpbmUxLmNsYXNzTmFtZSA9ICd0ZXh0LXNtIGZvbnQtbWVkaXVtIHRydW5jYXRlJztcbiAgICAgICAgbGluZTEudGV4dENvbnRlbnQgPSBpdC5hbmNob3IudmFsdWU7XG4gICAgICAgIG1haW4uYXBwZW5kKGxpbmUxKTtcbiAgICAgICAgbGkuYXBwZW5kKGJhZGdlLCBtYWluKTtcbiAgICAgICAgZnJhZy5hcHBlbmRDaGlsZChsaSk7XG4gICAgfVxuICAgIHNlbGVjdExpc3RFbC5yZXBsYWNlQ2hpbGRyZW4oZnJhZyk7XG59XG4iLCJpbXBvcnQgaTE4biBmcm9tICdAY29tbW9uL2kxOG4nO1xuaW1wb3J0IHsgTVNHX1RZUEUgfSBmcm9tICdAY29tbW9uL21lc3NhZ2VzJztcbmltcG9ydCB7IGlzUmVzdHJpY3RlZCwgcGFnZUtleSB9IGZyb20gJ0Bjb21tb24vdXJsJztcbmltcG9ydCB7IGdldEFjdGl2ZVRhYiB9IGZyb20gJ0BpbmZyYS9jaHJvbWUvdGFicyc7XG5pbXBvcnQgeyBjb25uZWN0VG9UYWIgfSBmcm9tICdAcGFuZWwvbWVzc2FnaW5nL2Nvbm5lY3Rpb24nO1xuaW1wb3J0IHsgY2FwdHVyZUZ1bGxQYWdlIH0gZnJvbSAnQHBhbmVsL3NlcnZpY2VzL2NhcHR1cmUnO1xuaW1wb3J0IHsgZ2V0U3RhdGUsIGhhbmRsZVNlbGVjdGVkLCBzZXRTdGF0ZSB9IGZyb20gJ0BwYW5lbC9zdGF0ZS9zdG9yZSc7XG5pbXBvcnQgeyBTVEFUVVMgfSBmcm9tICdAcGFuZWwvdmlldy9zdGF0dXMnO1xuaW1wb3J0IHsgcmVuZGVyTGlzdCwgdXBkYXRlU3RhdHVzVUksIHVwZGF0ZVRvZ2dsZUljb25VSSB9IGZyb20gJ0BwYW5lbC92aWV3L3VpJztcbmNvbnN0IHRvZ2dsZUJ0biA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd0b2dnbGUtc2VsZWN0Jyk7XG5jb25zdCB0b2dnbGVMYWJlbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd0b2dnbGUtbGFiZWwnKTtcbmNvbnN0IGNsZWFyQnRuID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2NsZWFyJyk7XG5jb25zdCBjYXB0dXJlQnRuID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2NhcHR1cmUnKTtcbmxldCBjdXJyZW50VGFiSWQgPSBudWxsO1xubGV0IGN1cnJlbnRQYWdlS2V5ID0gJyc7XG5sZXQgc2VsZWN0aW9uRW5hYmxlZCA9IGZhbHNlO1xubWFpbigpLmNhdGNoKGNvbnNvbGUuZXJyb3IpO1xuLyoqXG4gKiBPcmNoZXN0cmF0ZXMgVUkgaW5pdGlhbGl6YXRpb24gYW5kIGNvbm5lY3Rpb24gbGlmZWN5Y2xlLlxuICogLSBBcHBseSBpMThuXG4gKiAtIERldGVjdCBhbmQgY29ubmVjdCB0byB0aGUgYWN0aXZlIHRhYlxuICogLSBSZXN0b3JlIHN0YXRlIGFuZCBwZXJmb3JtIGluaXRpYWwgcmVuZGVyXG4gKiAtIEJpbmQgVUkgZXZlbnRzXG4gKi9cbmFzeW5jIGZ1bmN0aW9uIG1haW4oKSB7XG4gICAgaTE4bi5sb2NhbGl6ZShkb2N1bWVudCk7XG4gICAgY29uc3QgdGFiID0gYXdhaXQgZ2V0QWN0aXZlVGFiKCk7XG4gICAgaWYgKCF0YWI/LmlkIHx8IGlzUmVzdHJpY3RlZCh0YWIudXJsKSlcbiAgICAgICAgcmV0dXJuIHVwZGF0ZVN0YXR1c1VJKFNUQVRVUy5SRVNUUklDVEVEKTtcbiAgICBjdXJyZW50VGFiSWQgPSB0YWIuaWQ7XG4gICAgY3VycmVudFBhZ2VLZXkgPSBwYWdlS2V5KHRhYi51cmwpO1xuICAgIHVwZGF0ZVN0YXR1c1VJKFNUQVRVUy5DT05ORUNUSU5HKTtcbiAgICBjb25zdCBjb25uID0gYXdhaXQgY29ubmVjdFRvVGFiKGN1cnJlbnRUYWJJZCk7XG4gICAgY29ubi5vbkRpc2Nvbm5lY3QoKCkgPT4ge1xuICAgICAgICB1cGRhdGVTdGF0dXNVSShTVEFUVVMuRElTQ09OTkVDVEVEKTtcbiAgICAgICAgc2VsZWN0aW9uRW5hYmxlZCA9IGZhbHNlO1xuICAgICAgICB0b2dnbGVMYWJlbC50ZXh0Q29udGVudCA9IGkxOG4uZ2V0KCd0b2dnbGVfb2ZmJyk7XG4gICAgfSk7XG4gICAgLy8gUmVjZWl2ZXMgbWVzc2FnZXMgZnJvbSBDb250ZW50IOKGkiBQYW5lbC5cbiAgICAvLyBBcHBsaWVzIHNlbGVjdGlvbiByZXN1bHRzIChhbmNob3JzKSwgdXBkYXRlcyBzdGF0ZSwgYW5kIHJlLXJlbmRlcnMuXG4gICAgY29ubi5wb3J0Lm9uTWVzc2FnZS5hZGRMaXN0ZW5lcihhc3luYyAobXNnKSA9PiB7XG4gICAgICAgIGlmICghbXNnIHx8ICFtc2cudHlwZSlcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgaWYgKG1zZy50eXBlID09PSBNU0dfVFlQRS5TRUxFQ1RFRCkge1xuICAgICAgICAgICAgY29uc3QgbmV3U3RhdGUgPSBhd2FpdCBoYW5kbGVTZWxlY3RlZChjdXJyZW50UGFnZUtleSwgbXNnLnBheWxvYWQuYW5jaG9ycyk7XG4gICAgICAgICAgICByZW5kZXJMaXN0KG5ld1N0YXRlLml0ZW1zKTtcbiAgICAgICAgICAgIGF3YWl0IGNvbm4uYXBpLnJlbmRlcihuZXdTdGF0ZS5pdGVtcyk7XG4gICAgICAgIH1cbiAgICB9KTtcbiAgICAvLyBSZXN0b3JlXG4gICAgY29uc3Qgc3QgPSBhd2FpdCBnZXRTdGF0ZShjdXJyZW50UGFnZUtleSk7XG4gICAgYXdhaXQgY29ubi5hcGkucmVuZGVyKHN0Lml0ZW1zKTtcbiAgICByZW5kZXJMaXN0KHN0Lml0ZW1zKTtcbiAgICB1cGRhdGVTdGF0dXNVSShTVEFUVVMuQ09OTkVDVEVEKTtcbiAgICAvLyBUb2dnbGVzIHNlbGVjdGlvbiBtb2RlIGZyb20gdGhlIFBhbmVsIGFuZCBub3RpZmllcyBDb250ZW50LlxuICAgIHRvZ2dsZUJ0bi5vbmNsaWNrID0gYXN5bmMgKCkgPT4ge1xuICAgICAgICBzZWxlY3Rpb25FbmFibGVkID0gIXNlbGVjdGlvbkVuYWJsZWQ7XG4gICAgICAgIHVwZGF0ZVRvZ2dsZUljb25VSShzZWxlY3Rpb25FbmFibGVkKTtcbiAgICAgICAgYXdhaXQgY29ubi5hcGkudG9nZ2xlU2VsZWN0KHNlbGVjdGlvbkVuYWJsZWQpO1xuICAgIH07XG4gICAgLy8gQ2xlYXJzIGFsbCBzZWxlY3Rpb25zIGZyb20gc3RvcmFnZSBhbmQgdGhlIENvbnRlbnQgb3ZlcmxheS5cbiAgICBjbGVhckJ0bi5vbmNsaWNrID0gYXN5bmMgKCkgPT4ge1xuICAgICAgICBjb25zdCBjbGVhcmVkID0geyBpdGVtczogW10sIG5leHRJZDogMSwgbmV4dExhYmVsOiAxIH07XG4gICAgICAgIGF3YWl0IHNldFN0YXRlKGN1cnJlbnRQYWdlS2V5LCBjbGVhcmVkKTtcbiAgICAgICAgcmVuZGVyTGlzdChbXSk7XG4gICAgICAgIGF3YWl0IGNvbm4uYXBpLmNsZWFyKCk7XG4gICAgfTtcbiAgICAvLyBJbml0aWF0ZXMgYSBmdWxsLXBhZ2Ugc2NyZWVuc2hvdCBvZiB0aGUgY3VycmVudCB0YWIgYW5kIHNhdmVzIGl0IHZpYSB0aGUgRG93bmxvYWRzIEFQSS5cbiAgICAvLyBFcnJvcnMgYXJlIGxvZ2dlZCB0byB0aGUgY29uc29sZSB3aXRob3V0IGludGVycnVwdGluZyB0aGUgVUkuXG4gICAgY2FwdHVyZUJ0bi5vbmNsaWNrID0gYXN5bmMgKCkgPT4ge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgYXdhaXQgY2FwdHVyZUZ1bGxQYWdlKHsgdGFiSWQ6IGN1cnJlbnRUYWJJZCB9KTtcbiAgICAgICAgfVxuICAgICAgICBjYXRjaCAoZSkge1xuICAgICAgICAgICAgY29uc29sZS5lcnJvcignRnVsbCBjYXB0dXJlIGZhaWxlZCcsIGUpO1xuICAgICAgICB9XG4gICAgfTtcbn1cbiIsImV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRBY3RpdmVUYWIoKSB7XG4gICAgY29uc3QgdGFicyA9IGF3YWl0IGNocm9tZS50YWJzLnF1ZXJ5KHsgYWN0aXZlOiB0cnVlLCBjdXJyZW50V2luZG93OiB0cnVlIH0pO1xuICAgIHJldHVybiB0YWJzWzBdO1xufVxuIiwiaW1wb3J0IHsgQ0hBTk5FTCB9IGZyb20gJ0Bjb21tb24vY29uc3RhbnRzJztcbmltcG9ydCB7IFBhbmVsQXBpIH0gZnJvbSAnLi9hcGknO1xuaW1wb3J0IHsgUG9ydFJwYyB9IGZyb20gJy4vcG9ydF9ycGMnO1xuLyoqXG4gKiBJbmplY3RzIHRoZSBjb250ZW50IHNjcmlwdCBpbnRvIHRoZSB0YWIgaWYgbmVlZGVkLCBhbmRcbiAqIGluaXRpYWxpemVzIHRoZSBQb3J0IGNvbm5lY3Rpb24gYW5kIFJQQyBmb3IgUGFuZWwg4oaUIENvbnRlbnQuXG4gKlxuICogQHBhcmFtIHRhYklkIC0gVGFyZ2V0IHRhYiBpZFxuICogQHJldHVybnMgQSBjb25uZWN0aW9uIG9iamVjdCBidW5kbGluZyBBUEksIFBvcnQsIGFuZCBSUENcbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGNvbm5lY3RUb1RhYih0YWJJZCkge1xuICAgIGF3YWl0IGNocm9tZS5zY3JpcHRpbmcuZXhlY3V0ZVNjcmlwdCh7XG4gICAgICAgIHRhcmdldDogeyB0YWJJZCB9LFxuICAgICAgICBmaWxlczogWydjb250ZW50L21haW4uanMnXVxuICAgIH0pLmNhdGNoKCgpID0+IHsgfSk7XG4gICAgY29uc3QgcG9ydCA9IGNocm9tZS50YWJzLmNvbm5lY3QodGFiSWQsIHsgbmFtZTogQ0hBTk5FTC5QQU5FTF9DT05URU5UIH0pO1xuICAgIGNvbnN0IHJwYyA9IG5ldyBQb3J0UnBjKHBvcnQpO1xuICAgIGNvbnN0IGFwaSA9IG5ldyBQYW5lbEFwaShycGMpO1xuICAgIGNvbnN0IGxpc3RlbmVycyA9IFtdO1xuICAgIHBvcnQub25EaXNjb25uZWN0LmFkZExpc3RlbmVyKCgpID0+IGxpc3RlbmVycy5mb3JFYWNoKGZuID0+IGZuKCkpKTtcbiAgICByZXR1cm4ge1xuICAgICAgICBhcGksIHBvcnQsIHJwYyxcbiAgICAgICAgb25EaXNjb25uZWN0OiAoY2IpID0+IGxpc3RlbmVycy5wdXNoKGNiKSxcbiAgICAgICAgZGlzcG9zZTogKCkgPT4ge1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICBwb3J0LmRpc2Nvbm5lY3QoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNhdGNoIHsgLyogbm8tb3AgKi8gfVxuICAgICAgICB9LFxuICAgIH07XG59XG4iLCJpbXBvcnQgeyBpc1Jlc3RyaWN0ZWQgfSBmcm9tICdAY29tbW9uL3VybCc7XG5pbXBvcnQgeyBhdHRhY2gsIGRldGFjaCwgc2VuZCB9IGZyb20gJ0BpbmZyYS9jZHAvY2RwX2NsaWVudCc7XG4vKipcbiAqIE5vcm1hbGl6ZXMgYSBzdHJpbmcgZm9yIHNhZmUgdXNlIGFzIGEgZmlsZW5hbWU6XG4gKiByZXBsYWNlcyByZXNlcnZlZCBjaGFyYWN0ZXJzLCBjb2xsYXBzZXMgd2hpdGVzcGFjZSwgYW5kIHRyaW1zIGVuZHMuXG4gKlxuICogQHBhcmFtIHMgLSBSYXcgc3RyaW5nIHRvIHNhbml0aXplLlxuICogQHJldHVybnMgU2FuaXRpemVkIGZpbGVuYW1lLXNhZmUgc3RyaW5nLlxuICovXG5mdW5jdGlvbiBzYW5pdGl6ZUZvckZpbGVuYW1lKHMpIHtcbiAgICByZXR1cm4gcy5yZXBsYWNlKC9bXFxcXC86Kj9cIjw+fF0vZywgJ18nKS5yZXBsYWNlKC9cXHMrL2csICcgJykudHJpbSgpO1xufVxuLyoqXG4gKiBCdWlsZHMgYSB0aW1lc3RhbXBlZCBmaWxlbmFtZSBmb3IgdGhlIGNhcHR1cmUgYmFzZWQgb24gdGhlIHRhYidzIHRpdGxlIG9yIGhvc3QuXG4gKiBUcnVuY2F0ZXMgdGhlIGJhc2UgbmFtZSB0byA4MCBjaGFyYWN0ZXJzIGFuZCBhcHBlbmRzIHRoZSBwcm9wZXIgZXh0ZW5zaW9uLlxuICpcbiAqIEBwYXJhbSB0YWIgLSBTb3VyY2UgdGFiICh0aXRsZS91cmwgdXNlZCBmb3IgbmFtaW5nKS5cbiAqIEBwYXJhbSBmbXQgLSBUYXJnZXQgaW1hZ2UgZm9ybWF0ICgncG5nJyB8ICdqcGVnJykuXG4gKiBAcmV0dXJucyBBIGZpbGVuYW1lIGxpa2UgYHBhZ2UtMjAyNS0wOC0xM1QxMC0yMC0zMC0wMDBaLnBuZ2AuXG4gKi9cbmZ1bmN0aW9uIG1ha2VGaWxlbmFtZSh0YWIsIGZtdCkge1xuICAgIGNvbnN0IHRpdGxlID0gdGFiLnRpdGxlICYmIHRhYi50aXRsZS50cmltKCkgPyB0YWIudGl0bGUgOiAnJztcbiAgICBsZXQgYmFzZSA9IHRpdGxlIHx8ICgoKSA9PiB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICByZXR1cm4gbmV3IFVSTCh0YWIudXJsID8/ICcnKS5ob3N0IHx8ICdwYWdlJztcbiAgICAgICAgfVxuICAgICAgICBjYXRjaCB7XG4gICAgICAgICAgICByZXR1cm4gJ3BhZ2UnO1xuICAgICAgICB9XG4gICAgfSkoKTtcbiAgICBiYXNlID0gc2FuaXRpemVGb3JGaWxlbmFtZShiYXNlKTtcbiAgICBpZiAoYmFzZS5sZW5ndGggPiA4MClcbiAgICAgICAgYmFzZSA9IGJhc2Uuc2xpY2UoMCwgODApO1xuICAgIGNvbnN0IHRzID0gbmV3IERhdGUoKS50b0lTT1N0cmluZygpLnJlcGxhY2UoL1s6Ll0vZywgJy0nKTtcbiAgICByZXR1cm4gYCR7YmFzZX0tJHt0c30uJHtmbXR9YDtcbn1cbi8qKlxuICogQ2FwdHVyZXMgYSBzaW5nbGUgZnVsbC1wYWdlIHNjcmVlbnNob3QgKGluY2x1ZGluZyBjb250ZW50IGJleW9uZCB0aGUgdmlld3BvcnQpXG4gKiBhbmQgc2F2ZXMgaXQgdmlhIHRoZSBEb3dubG9hZHMgQVBJLlxuICpcbiAqIEBwYXJhbSBvcHRzIC0gQ2FwdHVyZSBvcHRpb25zICh0YWIgaWQsIGZvcm1hdCwgcXVhbGl0eSwgc2NhbGUsIGV0Yy4pLlxuICogQHJldHVybnMgVGhlIGBkb3dubG9hZElkYCB3aGVuIHNhdmVkIHN1Y2Nlc3NmdWxseTsgYHVuZGVmaW5lZGAgd2hlbiBjYXB0dXJlIGlzIHNraXBwZWQuXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBjYXB0dXJlRnVsbFBhZ2Uob3B0cykge1xuICAgIGNvbnN0IHRhYiA9IGF3YWl0IGNocm9tZS50YWJzLmdldChvcHRzLnRhYklkKTtcbiAgICBpZiAoIXRhYi5pZCB8fCBpc1Jlc3RyaWN0ZWQodGFiLnVybCkpIHtcbiAgICAgICAgY29uc29sZS53YXJuKCdDYXB0dXJpbmcgaXMgbm90IHBvc3NpYmxlIGR1ZSB0byByZXN0cmljdGVkIFVSTDonLCB0YWIudXJsKTtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBjb25zdCB0YXJnZXQgPSB7IHRhYklkOiB0YWIuaWQgfTtcbiAgICBjb25zdCBmbXQgPSBvcHRzLmZvcm1hdCA/PyAncG5nJztcbiAgICBjb25zdCBzZXR0bGVNcyA9IG9wdHMuc2V0dGxlTXMgPz8gNTAwO1xuICAgIGNvbnN0IHNjYWxlID0gb3B0cy5zY2FsZSA/PyAxO1xuICAgIGF3YWl0IGF0dGFjaCh0YXJnZXQpO1xuICAgIHRyeSB7XG4gICAgICAgIGF3YWl0IHNlbmQodGFyZ2V0LCAnUGFnZS5lbmFibGUnKTtcbiAgICAgICAgaWYgKG9wdHMuYnJpbmdUb0Zyb250ID8/IHRydWUpIHtcbiAgICAgICAgICAgIGF3YWl0IHNlbmQodGFyZ2V0LCAnUGFnZS5icmluZ1RvRnJvbnQnKTtcbiAgICAgICAgfVxuICAgICAgICAvLyBDU1MgY29udGVudCBkaW1lbnNpb25zIG9mIHRoZSBwYWdlXG4gICAgICAgIGNvbnN0IGxtID0gYXdhaXQgc2VuZCh0YXJnZXQsICdQYWdlLmdldExheW91dE1ldHJpY3MnKTtcbiAgICAgICAgY29uc3Qgd2lkdGggPSBNYXRoLm1heCgxLCBNYXRoLmNlaWwobG0uY3NzQ29udGVudFNpemU/LndpZHRoID8/IDEpIHwgMCk7XG4gICAgICAgIGNvbnN0IGhlaWdodCA9IE1hdGgubWF4KDEsIE1hdGguY2VpbChsbS5jc3NDb250ZW50U2l6ZT8uaGVpZ2h0ID8/IDEpIHwgMCk7XG4gICAgICAgIC8vIEF2b2lkIHJlcGVhdGVkIHZpZXdwb3J0IHN0aXRjaGluZzogb3ZlcnJpZGUgdmlld3BvcnQgdG8gY292ZXIgdGhlIGZ1bGwgcGFnZVxuICAgICAgICBhd2FpdCBzZW5kKHRhcmdldCwgJ0VtdWxhdGlvbi5zZXREZXZpY2VNZXRyaWNzT3ZlcnJpZGUnLCB7XG4gICAgICAgICAgICB3aWR0aCwgaGVpZ2h0LCBkZXZpY2VTY2FsZUZhY3RvcjogMSwgbW9iaWxlOiBmYWxzZSxcbiAgICAgICAgICAgIHNjcmVlbldpZHRoOiB3aWR0aCwgc2NyZWVuSGVpZ2h0OiBoZWlnaHQsIHBvc2l0aW9uWDogMCwgcG9zaXRpb25ZOiAwLFxuICAgICAgICB9KTtcbiAgICAgICAgLy8gU2Nyb2xsIHRvIHRvcCAmIHdhaXQgYnJpZWZseSBmb3IgbGF5b3V0L2ltYWdlIHN0YWJpbGl6YXRpb25cbiAgICAgICAgYXdhaXQgc2VuZCh0YXJnZXQsICdSdW50aW1lLmV2YWx1YXRlJywgeyBleHByZXNzaW9uOiAnd2luZG93LnNjcm9sbFRvKDAsMCknIH0pO1xuICAgICAgICBhd2FpdCBuZXcgUHJvbWlzZSgocikgPT4gc2V0VGltZW91dChyLCBzZXR0bGVNcykpO1xuICAgICAgICA7XG4gICAgICAgIC8vIEZ1bGwtc2l6ZSBjYXB0dXJlXG4gICAgICAgIGNvbnN0IGNsaXAgPSB7IHg6IDAsIHk6IDAsIHdpZHRoLCBoZWlnaHQsIHNjYWxlIH07XG4gICAgICAgIGNvbnN0IGNhcFBhcmFtcyA9IHtcbiAgICAgICAgICAgIGZvcm1hdDogZm10LFxuICAgICAgICAgICAgZnJvbVN1cmZhY2U6IHRydWUsXG4gICAgICAgICAgICBjYXB0dXJlQmV5b25kVmlld3BvcnQ6IHRydWUsXG4gICAgICAgICAgICBjbGlwLFxuICAgICAgICB9O1xuICAgICAgICBpZiAoZm10ID09PSAnanBlZycgJiYgdHlwZW9mIG9wdHMucXVhbGl0eSA9PT0gJ251bWJlcicpIHtcbiAgICAgICAgICAgIGNhcFBhcmFtcy5xdWFsaXR5ID0gTWF0aC5taW4oMTAwLCBNYXRoLm1heCgwLCBNYXRoLnJvdW5kKG9wdHMucXVhbGl0eSkpKTtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCB7IGRhdGEgfSA9IGF3YWl0IHNlbmQodGFyZ2V0LCAnUGFnZS5jYXB0dXJlU2NyZWVuc2hvdCcsIGNhcFBhcmFtcyk7XG4gICAgICAgIGNvbnN0IG1pbWUgPSBmbXQgPT09ICdwbmcnID8gJ2ltYWdlL3BuZycgOiAnaW1hZ2UvanBlZyc7XG4gICAgICAgIGNvbnN0IHVybCA9IGBkYXRhOiR7bWltZX07YmFzZTY0LCR7ZGF0YX1gO1xuICAgICAgICBjb25zdCBmaWxlbmFtZSA9IG9wdHMuZmlsZW5hbWUgPz8gbWFrZUZpbGVuYW1lKHRhYiwgZm10KTtcbiAgICAgICAgY29uc3QgZG93bmxvYWRJZCA9IGF3YWl0IGNocm9tZS5kb3dubG9hZHMuZG93bmxvYWQoe1xuICAgICAgICAgICAgdXJsLFxuICAgICAgICAgICAgZmlsZW5hbWUsXG4gICAgICAgICAgICBzYXZlQXM6IGZhbHNlLFxuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIGRvd25sb2FkSWQ7XG4gICAgfVxuICAgIGZpbmFsbHkge1xuICAgICAgICAvLyBDbGVhciBvdmVycmlkZGVuIHZpZXdwb3J0IG1ldHJpY3NcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGF3YWl0IHNlbmQodGFyZ2V0LCAnRW11bGF0aW9uLmNsZWFyRGV2aWNlTWV0cmljc092ZXJyaWRlJyk7XG4gICAgICAgIH1cbiAgICAgICAgY2F0Y2ggeyAvKiBuby1vcCAqLyB9XG4gICAgICAgIC8vIEFsd2F5cyBkZXRhY2hcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGF3YWl0IGRldGFjaCh0YXJnZXQpO1xuICAgICAgICB9XG4gICAgICAgIGNhdGNoIHsgLyogbm8tb3AgKi8gfVxuICAgIH1cbn1cbiJdLCJuYW1lcyI6WyJnZXQiLCJrZXkiLCJzdWJzIiwiY2hyb21lIiwiaTE4biIsImdldE1lc3NhZ2UiLCJsb2NhbGl6ZSIsInJvb3QiLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJmb3JFYWNoIiwiZWwiLCJnZXRBdHRyaWJ1dGUiLCJ0ZXh0Q29udGVudCIsInNwZWMiLCJwYWlyIiwic3BsaXQiLCJhdHRyIiwibWFwIiwicyIsInRyaW0iLCJzZXRBdHRyaWJ1dGUiLCJNU0dfVFlQRSIsImlzUmVzdHJpY3RlZCIsInVybCIsInN0YXJ0c1dpdGgiLCJDSEFOTkVMIiwiUGFuZWxBcGkiLCJycGMiLCJjb25zdHJ1Y3RvciIsInRoaXMiLCJzZW5kIiwiYm9keSIsInJlcSIsImlkIiwiY3J5cHRvIiwicmFuZG9tVVVJRCIsImV4cGVjdFJlcGx5IiwicmVuZGVyIiwiaXRlbXMiLCJ0eXBlIiwicGF5bG9hZCIsInRvZ2dsZVNlbGVjdCIsImVuYWJsZWQiLCJjbGVhciIsInBpbmciLCJQb3J0UnBjIiwicG9ydCIsInBlbmRpbmciLCJNYXAiLCJvbk1lc3NhZ2UiLCJhZGRMaXN0ZW5lciIsIm1zZyIsImlzUmVzcG9uc2UiLCJkZWxldGUiLCJvbkRpc2Nvbm5lY3QiLCJyZXNvbHZlIiwib2siLCJlcnJvciIsInRpbWVvdXRNcyIsIlByb21pc2UiLCJ0aW1lciIsInNldFRpbWVvdXQiLCJ1bmRlZmluZWQiLCJzZXQiLCJyZXMiLCJjbGVhclRpbWVvdXQiLCJwb3N0TWVzc2FnZSIsImxhc3RFcnJvciIsImVyciIsInJ1bnRpbWUiLCJFcnJvciIsIm1lc3NhZ2UiLCJTdHJpbmciLCJhc3luYyIsInRhcmdldCIsIm1ldGhvZCIsInBhcmFtcyIsInJlamVjdCIsImRlYnVnZ2VyIiwic2VuZENvbW1hbmQiLCJyZXN1bHQiLCJST09UX0tFWSIsInJlYWRBbGwiLCJzdG9yYWdlIiwibG9jYWwiLCJnZXRTdGF0ZSIsInBhZ2VLZXkiLCJuZXh0SWQiLCJuZXh0TGFiZWwiLCJzZXRTdGF0ZSIsInBhZ2VLZXlTdHIiLCJzdGF0ZSIsIndyaXRlQWxsIiwiU1RBVFVTX01TR19LRVkiLCJSRVNUUklDVEVEIiwiQ09OTkVDVElORyIsIkNPTk5FQ1RFRCIsIkRJU0NPTk5FQ1RFRCIsIlNUQVRVU19MQUJFTF9TVFlMRSIsImRvdCIsInN0YXR1c0VsIiwiZ2V0RWxlbWVudEJ5SWQiLCJ0b2dnbGVJY29uRWwiLCJ0b2dnbGVMYWJlbEVsIiwic2VsZWN0Q291bnRFbCIsInNlbGVjdEVtcHR5RWwiLCJzZWxlY3RMaXN0RWwiLCJTVEFUVVNfQkFTRV9CT0RZIiwiVE9HR0xFX0lDT05fQkFTRSIsIlRPR0dMRV9JQ09OX09OIiwiVE9HR0xFX0lDT05fT0ZGIiwidXBkYXRlU3RhdHVzVUkiLCJzdHlsZSIsImNsYXNzTmFtZSIsImNsYXNzTGlzdCIsImFkZCIsImNyZWF0ZUVsZW1lbnQiLCJ0ZXh0IiwibXNnS2V5IiwiZ2V0U3RhdHVzTWVzc2FnZSIsInJlcGxhY2VDaGlsZHJlbiIsInJlbmRlckxpc3QiLCJpc0VtcHR5IiwibGVuZ3RoIiwicmVtb3ZlIiwiZnJhZyIsImNyZWF0ZURvY3VtZW50RnJhZ21lbnQiLCJpdCIsImxpIiwiZGF0YXNldCIsImJhZGdlIiwibGFiZWwiLCJtYWluIiwibGluZTEiLCJhbmNob3IiLCJ2YWx1ZSIsImFwcGVuZCIsImFwcGVuZENoaWxkIiwidG9nZ2xlQnRuIiwidG9nZ2xlTGFiZWwiLCJjbGVhckJ0biIsImNhcHR1cmVCdG4iLCJjdXJyZW50VGFiSWQiLCJjdXJyZW50UGFnZUtleSIsInNlbGVjdGlvbkVuYWJsZWQiLCJ0YWIiLCJ0YWJzIiwicXVlcnkiLCJhY3RpdmUiLCJjdXJyZW50V2luZG93IiwiZ2V0QWN0aXZlVGFiIiwiaW5jbHVkZUhhc2giLCJ1IiwiVVJMIiwib3JpZ2luIiwicGF0aG5hbWUiLCJzZWFyY2giLCJoYXNoIiwiY29ubiIsInRhYklkIiwic2NyaXB0aW5nIiwiZXhlY3V0ZVNjcmlwdCIsImZpbGVzIiwiY2F0Y2giLCJjb25uZWN0IiwibmFtZSIsImFwaSIsImxpc3RlbmVycyIsImZuIiwiY2IiLCJwdXNoIiwiZGlzcG9zZSIsImRpc2Nvbm5lY3QiLCJjb25uZWN0VG9UYWIiLCJuZXdTdGF0ZSIsImFuY2hvcnMiLCJ1bmlxIiwiQXJyYXkiLCJmcm9tIiwiU2V0IiwiYSIsInYiLCJmaW5kIiwiZmlsdGVyIiwiQm9vbGVhbiIsInJlbW92ZWRJZHMiLCJ0b0FkZCIsImZvdW5kIiwia2luZCIsInBhdGNoIiwiYWRkZWQiLCJoYXNSZW1vdmFsIiwidG9SZW1vdmUiLCJoYXMiLCJ1cGRhdGVkIiwiaSIsIm1ldGEiLCJyZWxhYmVsU2VxdWVudGlhbCIsImFwcGx5UGF0Y2giLCJoYW5kbGVTZWxlY3RlZCIsInN0Iiwib25jbGljayIsIm9wdHMiLCJjb25zb2xlIiwid2FybiIsImZtdCIsImZvcm1hdCIsInNldHRsZU1zIiwic2NhbGUiLCJhdHRhY2giLCJicmluZ1RvRnJvbnQiLCJsbSIsIndpZHRoIiwiTWF0aCIsIm1heCIsImNlaWwiLCJjc3NDb250ZW50U2l6ZSIsImhlaWdodCIsImRldmljZVNjYWxlRmFjdG9yIiwibW9iaWxlIiwic2NyZWVuV2lkdGgiLCJzY3JlZW5IZWlnaHQiLCJwb3NpdGlvblgiLCJwb3NpdGlvblkiLCJleHByZXNzaW9uIiwiciIsImNhcFBhcmFtcyIsImZyb21TdXJmYWNlIiwiY2FwdHVyZUJleW9uZFZpZXdwb3J0IiwiY2xpcCIsIngiLCJ5IiwicXVhbGl0eSIsIm1pbiIsInJvdW5kIiwiZGF0YSIsImZpbGVuYW1lIiwiYmFzZSIsInRpdGxlIiwiaG9zdCIsInJlcGxhY2UiLCJzbGljZSIsIkRhdGUiLCJ0b0lTT1N0cmluZyIsIm1ha2VGaWxlbmFtZSIsImRvd25sb2FkcyIsImRvd25sb2FkIiwic2F2ZUFzIiwiZGV0YWNoIiwiY2FwdHVyZUZ1bGxQYWdlIiwiZSJdLCJzb3VyY2VSb290IjoiIn0=